# Функциональные зависимости и нормализация
---
## Отношения и зависимости
### Relation image
* **ФЗ**:
    + {image_id} → name, created_at
    + {name} → image_id, created_at

* **Потенциальные ключи**:
    + image_id
    + name

* **Первичный ключ**: image_id

* **Описание**: в каждой строке таблицы "image" хранятся сведения о файле-картинке: id, имя файла, дата создания.

### Relation user
* **ФЗ**:
    + {user_id} → email, nickname, password_hash, register_at, avatar_id
    + {nickname} → user_id, email, password_hash, register_at, avatar_id
    + {email} → user_id, nickname, password_hash, register_at, avatar_id

* **Потенциальные ключи**:
    + user_id
    + email
    + nickname

* **Первичный ключ**: user_id

* **Описание**: в каждой строке таблицы "user" хранятся сведения о конкретном пользователе: id, почта, никнейм, пароль (в виде хеша), дата регистрации и ссылка на картинку-аватар в таблице "image".

### Relation pin
* **ФЗ**: {pin_id} → author_id, title, description, content_id, click_url, allow_coments, created_at

* **Потенциальные ключи**:
    + pin_id

* **Первичный ключ**: pin_id

* **Описание**: в каждой строке таблицы "pin" хранятся сведения о конкретном пине: id пина, id автора, заголовок, описание, ссылка на картинку пина в таблице "image", ссылка перехода на сайт автора, разрешение коммантирования, дата создания.

### Relation board
* **ФЗ**: {board_id} → title, description, cover_id, created_at, visibility_type

* **Потенциальные ключи**:
    + board_id

* **Первичный ключ**: board_id

* **Описание**: в каждой строке таблицы "board" хранятся сведения о конкретной доске: id, заголовок, описание, ссылка на картинку-обложку в таблице "image", тип видимости/приватности, дата создания.

### Relation like
* **ФЗ**: {pin_id, user_id} → created_at

* **Потенциальные ключи**:
    + pin_id, user_id

* **Первичный ключ**: pin_id, user_id

* **Описание**: в каждой строке таблицы "like" хранятся сведения о конкретном лайке: id пина, на который поставлен лайк, и id пользователя, поставившего этот лайк.

### Relation board_author
* **ФЗ**: -

* **Потенциальные ключи**:
    + author_id, board_id

* **Первичный ключ**: author_id, board_id

* **Описание**: в каждой строке таблицы "board_author" хранятся сведения о принадлежности пользователя к числу авторов доски: id пользователя/автора, id доски.

### Relation board_pin
* **ФЗ**: {pin_id, board_id} → created_at

* **Потенциальные ключи**:
    + pin_id, board_id

* **Первичный ключ**: pin_id, board_id

* **Описание**: в каждой строке таблицы "board_pin" хранятся сведения о принадлежности пина к доске: id пина, id доски и дата добавления пина в доску. 

> Таким образом, "board_author" и "board_pin" реализовывают many-to-many связь между соответствующими таблицами. Отсюда также видно, что у одной доски может быть больше 1 автора, а один и тот же пин может быть привязан к разным доскам.

## Доказательства соответствия нормальным формам
### 1НФ 
Все атрибуты отношений являются простыми, все используемые домены содержат только скалярные значения. Повторений строк в таблицах нет. 

### 2НФ
Выполнены условия 1НФ, а также каждый неключевой атрибут функционально-полно зависит от первичного ключа.

### 3НФ
Выполнены условия 2НФ, а также каждый неключевой атрибут нетранзитивно зависит от первичного ключа.

### НФБК
1. Для отношений, имеющих один первичный ключ, НФБК является 3НФ. Т.к. у всех описанных отношений первичный ключи единственный, то отношения находятся в НФБК.
2. Каждая нетривиальная и неприводимая слева функциональная зависимость обладает потенциальным ключом в качестве детерминанта.
3. Для любой нетривиальной функциональной зависимости {X} → Y, X является надключом.
